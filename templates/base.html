<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VirtualFlex Smart AI desk system</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light mb-0">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="/">
          <img src="{{ url_for('static', filename='virtualflex-logo.svg') }}" alt="VirtualFlex" class="brand-logo"/>
          <span class="brand-text">VirtualFlex Smart AI desk system</span>
        </a>
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link" href="/submit"><i class="fas fa-plus-circle"></i> Submit</a></li>
            <li class="nav-item"><a class="nav-link" href="/tickets"><i class="fas fa-list"></i> Tickets</a></li>
            <li class="nav-item"><a class="nav-link" href="/admin"><i class="fas fa-cog"></i> Admin</a></li>
            <li class="nav-item">
              <button id="theme-toggle" class="btn btn-ghost btn-sm nav-theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-moon"></i>
              </button>
            </li>
            {% if session.get('admin_logged_in') %}
              <li class="nav-item"><a class="nav-link logout-link" href="/admin/logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
    <div class="hero-section">
      <div class="hero-inner container">
        <div class="hero-content">
          <h2>VirtualFlex Smart AI desk system</h2>
          <p class="lead text-muted">AI-assisted ticket triage and tracking — faster resolutions, better insights.</p>
        </div>
        <div class="hero-illustration" aria-hidden="true">
          <!-- Lightweight abstract SVG illustration tuned to brand colors -->
          <svg width="260" height="96" viewBox="0 0 260 96" fill="none" xmlns="http://www.w3.org/2000/svg" role="img">
            <defs>
              <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#b00020" stop-opacity="0.95"/>
                <stop offset="100%" stop-color="#7a0000" stop-opacity="0.9"/>
              </linearGradient>
            </defs>
            <rect x="0" y="12" width="160" height="64" rx="8" fill="url(#g1)" />
            <rect x="96" y="0" width="164" height="64" rx="8" fill="#111" opacity="0.06" />
            <g transform="translate(12,20)" fill="#fff" opacity="0.95">
              <circle cx="12" cy="12" r="6" fill="#fff" opacity="0.15" />
              <rect x="28" y="6" width="90" height="12" rx="4" fill="#fff" opacity="0.18" />
              <rect x="28" y="26" width="70" height="8" rx="4" fill="#fff" opacity="0.12" />
            </g>
            <circle cx="220" cy="32" r="18" fill="#fff" opacity="0.08" />
          </svg>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="toast-container" id="toast-container"></div>
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="alert alert-{{ 'success' if category == 'success' else 'warning' }} alert-dismissible fade show toast-item {{ 'success' if category == 'success' else 'warning' }}" role="alert">
              <i class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-circle' }}"></i> {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </div>
    <footer class="footer mt-5">
      <p>&copy; 2025 VirtualFlex. VirtualFlex Smart AI desk system — AI-driven ticket triage.</p>
    </footer>
    <script>
      (function(){
        const root = document.documentElement;
        const toggle = document.getElementById('theme-toggle');
        const stored = localStorage.getItem('vf_theme') || 'light';
        function applyTheme(t){
          root.setAttribute('data-theme', t);
          if(toggle){
            toggle.innerHTML = t === 'dark' ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            toggle.setAttribute('aria-pressed', t==='dark');
          }
        }
        applyTheme(stored);
        if(toggle){
          toggle.addEventListener('click', ()=>{
            const next = (root.getAttribute('data-theme') === 'dark') ? 'light' : 'dark';
            localStorage.setItem('vf_theme', next);
            applyTheme(next);
          });
        }
        // Move existing alerts into toast container and auto-dismiss
        function initToasts(){
          const container = document.getElementById('toast-container');
          if(!container) return;
          // find current alerts (server-rendered)
          const alerts = Array.from(document.querySelectorAll('.alert'));
          alerts.forEach(a => {
            a.classList.add('toast-item');
            // move into container
            container.appendChild(a);
            // auto-dismiss after 5s unless it has .alert-warning
            const isWarning = a.classList.contains('alert-warning');
            setTimeout(()=>{
              try{ a.classList.remove('show'); a.remove(); }catch(e){}
            }, isWarning ? 7000 : 4500);
          });
        }
        // run on DOM ready
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initToasts);
        else initToasts();
      })();
    </script>
  </body>
  </html>
